for(var monographs=[{name:"あ行",words:[{kana:"あ",romaji:"a",origin:"安"},{kana:"い",romaji:"i",origin:"以"},{kana:"う",romaji:"u",origin:"宇"},{kana:"え",romaji:"e",origin:"衣"},{kana:"お",romaji:"o",origin:"於"}]},{name:"か行",words:[{kana:"か",romaji:"ka",origin:"加"},{kana:"き",romaji:"ki",origin:"幾"},{kana:"く",romaji:"ku",origin:"久"},{kana:"け",romaji:"ke",origin:"計"},{kana:"こ",romaji:"ko",origin:"己"}]},{name:"さ行",words:[{kana:"さ",romaji:"sa",origin:"左"},{kana:"し",romaji:"shi",origin:"之"},{kana:"す",romaji:"su",origin:"寸"},{kana:"せ",romaji:"se",origin:"世"},{kana:"そ",romaji:"so",origin:"曽"}]},{name:"た行",words:[{kana:"た",romaji:"ta",origin:"太"},{kana:"ち",romaji:"chi",origin:"知"},{kana:"つ",romaji:"tsu",origin:"川"},{kana:"て",romaji:"te",origin:"天"},{kana:"と",romaji:"to",origin:"止"}]},{name:"な行",words:[{kana:"な",romaji:"na",origin:"奈"},{kana:"に",romaji:"ni",origin:"仁"},{kana:"ぬ",romaji:"nu",origin:"奴"},{kana:"ね",romaji:"ne",origin:"祢"},{kana:"の",romaji:"no",origin:"乃"}]},{name:"は行",words:[{kana:"は",romaji:"ha",origin:"波"},{kana:"ひ",romaji:"hi",origin:"比"},{kana:"ふ",romaji:"fu",origin:"不"},{kana:"へ",romaji:"he",origin:"部"},{kana:"ほ",romaji:"ho",origin:"保"}]},{name:"ま行",words:[{kana:"ま",romaji:"ma",origin:"末"},{kana:"み",romaji:"mi",origin:"美"},{kana:"む",romaji:"mu",origin:"武"},{kana:"め",romaji:"me",origin:"女"},{kana:"も",romaji:"mo",origin:"毛"}]},{name:"や行",words:[{kana:"や",romaji:"ya",origin:"也"},{kana:"い",romaji:"i",origin:"以",placeholder:!0},{kana:"ゆ",romaji:"yu",origin:"由"},{kana:"え",romaji:"e",origin:"衣",placeholder:!0},{kana:"よ",romaji:"yo",origin:"与"}]},{name:"ら行",words:[{kana:"ら",romaji:"ra",origin:"良"},{kana:"り",romaji:"ri",origin:"利"},{kana:"る",romaji:"ru",origin:"留"},{kana:"れ",romaji:"re",origin:"礼"},{kana:"ろ",romaji:"ro",origin:"呂"}]},{name:"わ行",words:[{kana:"わ",romaji:"wa",origin:"和"},{kana:"い",romaji:"i",origin:"以",placeholder:!0},{kana:"う",romaji:"u",origin:"宇",placeholder:!0},{kana:"え",romaji:"e",origin:"衣",placeholder:!0},{kana:"を",romaji:"o",origin:"遠"}]}],monographsMap={},kanas=[],possibleRomaji={},addPossibleRomaji=function(a){for(var i=1;i<=a.length;++i){var r=a.substring(0,i);possibleRomaji[r]=!0}},i=0;i<monographs.length;++i)for(var row=monographs[i],words=row.words,j=0;j<words.length;++j){var word=words[j];monographsMap[word.romaji]=word.kana,addPossibleRomaji(word.romaji),kanas.push(word.kana)}var diacritics=[{name:"が行",words:[{kana:"が",romaji:"ga",origin:""},{kana:"ぎ",romaji:"gi",origin:""},{kana:"ぐ",romaji:"gu",origin:""},{kana:"げ",romaji:"ge",origin:""},{kana:"ご",romaji:"go",origin:""}]},{name:"ざ行",words:[{kana:"ざ",romaji:"za",origin:""},{kana:"じ",romaji:"ji",origin:""},{kana:"ず",romaji:"zu",origin:""},{kana:"ぜ",romaji:"ze",origin:""},{kana:"ぞ",romaji:"zo",origin:""}]},{name:"だ行",words:[{kana:"だ",romaji:"da",origin:""},{kana:"ぢ",romaji:"ji",origin:""},{kana:"づ",romaji:"dzu",origin:"",sound:"zu"},{kana:"で",romaji:"de",origin:""},{kana:"ど",romaji:"do",origin:""}]},{name:"ば行",words:[{kana:"ば",romaji:"ba",origin:""},{kana:"び",romaji:"bi",origin:""},{kana:"ぶ",romaji:"bu",origin:""},{kana:"べ",romaji:"be",origin:""},{kana:"ぼ",romaji:"bo",origin:""}]},{name:"ぱ行",words:[{kana:"ぱ",romaji:"pa",origin:""},{kana:"ぴ",romaji:"pi",origin:""},{kana:"ぷ",romaji:"pu",origin:""},{kana:"ぺ",romaji:"pe",origin:""},{kana:"ぽ",romaji:"po",origin:""}]}],diagraphs={name:"Digraphs (yōon)",words:[{kana:"きゃ",romaji:"kya"},{kana:"きゅ",romaji:"kyu"},{kana:"きょ",romaji:"kyo"},{kana:"しゃ",romaji:"sya"},{kana:"しゅ",romaji:"syu"},{kana:"しょ",romaji:"syo"},{kana:"ちゃ",romaji:"cya"},{kana:"ちゅ",romaji:"cyu"},{kana:"ちょ",romaji:"cyo"},{kana:"にゃ",romaji:"nya"},{kana:"にゅ",romaji:"nyu"},{kana:"にょ",romaji:"nyo"},{kana:"ひゃ",romaji:"hya"},{kana:"ひゅ",romaji:"hyu"},{kana:"ひょ",romaji:"hyo"},{kana:"みゃ",romaji:"mya"},{kana:"みゅ",romaji:"myu"},{kana:"みょ",romaji:"myo"},{kana:"りゃ",romaji:"rya"},{kana:"りゅ",romaji:"ryu"},{kana:"りょ",romaji:"ryo"}]},diagraphsWithDiacritics={name:"Digraphs with diacritics (yōon with (han)dakuten)",words:[{kana:"ぎゃ",romaji:"gya"},{kana:"ぎゅ",romaji:"gyu"},{kana:"ぎょ",romaji:"gyo"},{kana:"じゃ",romaji:"jya"},{kana:"じゅ",romaji:"jyu"},{kana:"じょ",romaji:"jyo"},{kana:"びゃ",romaji:"bya"},{kana:"びゅ",romaji:"byu"},{kana:"びょ",romaji:"byo"},{kana:"ぴゃ",romaji:"pya"},{kana:"ぴゅ",romaji:"pyu"},{kana:"ぴょ",romaji:"pyo"}]},width=960,height=700,radius=Math.min(width,height)/2,baseUrl="http://rockie-yang.github.io/learn-hiragana",color=d3.scale.category10(),svg=d3.select("body").append("svg").attr("width",width).attr("height",height).append("g").attr("transform","translate("+width/2+","+height/2+")"),plane=svg.append("path").attr("class","plane").attr("d","m25.21488,3.93375c-0.44355,0 -0.84275,0.18332 -1.17933,0.51592c-0.33397,0.33267 -0.61055,0.80884 -0.84275,1.40377c-0.45922,1.18911 -0.74362,2.85964 -0.89755,4.86085c-0.15655,1.99729 -0.18263,4.32223 -0.11741,6.81118c-5.51835,2.26427 -16.7116,6.93857 -17.60916,7.98223c-1.19759,1.38937 -0.81143,2.98095 -0.32874,4.03902l18.39971,-3.74549c0.38616,4.88048 0.94192,9.7138 1.42461,13.50099c-1.80032,0.52703 -5.1609,1.56679 -5.85232,2.21255c-0.95496,0.88711 -0.95496,3.75718 -0.95496,3.75718l7.53,-0.61316c0.17743,1.23545 0.28701,1.95767 0.28701,1.95767l0.01304,0.06557l0.06002,0l0.13829,0l0.0574,0l0.01043,-0.06557c0,0 0.11218,-0.72222 0.28961,-1.95767l7.53164,0.61316c0,0 0,-2.87006 -0.95496,-3.75718c-0.69044,-0.64577 -4.05363,-1.68813 -5.85133,-2.21516c0.48009,-3.77545 1.03061,-8.58921 1.42198,-13.45404l18.18207,3.70115c0.48009,-1.05806 0.86881,-2.64965 -0.32617,-4.03902c-0.88969,-1.03062 -11.81147,-5.60054 -17.39409,-7.89352c0.06524,-2.52287 0.04175,-4.88024 -0.1148,-6.89989l0,-0.00476c-0.15655,-1.99844 -0.44094,-3.6683 -0.90277,-4.8561c-0.22699,-0.59493 -0.50356,-1.07111 -0.83754,-1.40377c-0.33658,-0.3326 -0.73578,-0.51592 -1.18194,-0.51592l0,0l-0.00001,0l0,0z").attr("transform","translate(0,100) scale(5)").attr("fill","#ff7f0e"),currentKanas=[],timer,updateKana=function(){for(var a=0;a<currentKanas.length;++a){var i=currentKanas[a];i.y+=40,i.text.attr("transform","translate("+i.x+","+i.y+")")}},colorIndex=0,addKana=function(){if(updateKana(),currentKanas.length>0){var a=currentKanas[0];console.log(a.y),a.y>100&&(clearInterval(timer),new Audio(baseUrl+"/sound/95084__nakina4__i-will-never-die.wav").play())}var i=Math.floor(200*Math.random()),r=-320,o=kanas[Math.floor(Math.random()*kanas.length)],n=svg.append("text").text(o).attr("font-size","40px").attr("fill",color(colorIndex)).attr("transform","translate("+i+","+r+")");colorIndex=(colorIndex+1)%10,currentKanas.push({x:i,y:r,text:n,kana:o})},interval=1e3;timer=setInterval(addKana,interval);var bullet=svg.append("text").text("").attr("font-size","40px").attr("fill","#1f77b4").attr("transform","translate(100,120)"),shoot=function(a){if(currentKanas.length>0){var i=currentKanas[0];i.kana===a?(new Audio(baseUrl+"/sound/267341__coolguy244e__bullet-hit.mp3").play(),i.text.attr("class","shot"),d3.selectAll(".shot").remove(),currentKanas.shift()):new Audio(baseUrl+"/sound/68449__cdrk__broken-bottle-01.wav").play()}},romaji="";d3.select("body").on("keydown",function(){var a=String.fromCharCode(d3.event.keyCode).toLowerCase(),i=romaji+a;if(i in monographsMap){var r=monographsMap[i];return romaji="",bullet.text(r),void shoot(r)}if(i in possibleRomaji)return void(romaji=i);if(a in monographsMap){var r=monographsMap[a];return romaji="",bullet.text(r),void shoot(r)}}),new Audio(baseUrl+"/sound/21741__erdie__car-start.mp3").play();
